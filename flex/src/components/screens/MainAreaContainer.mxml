<?xml version="1.0" encoding="utf-8"?>
<base:BaseContainer xmlns:fx="http://ns.adobe.com/mxml/2009" 
                    xmlns:s="library://ns.adobe.com/flex/spark" 
                    xmlns:mx="library://ns.adobe.com/flex/mx"
                    xmlns:base="components.base.*"
                    xmlns:technologies="components.technologytree.*"
                    xmlns:unitsscreen="components.unitsscreen.*"
                    xmlns:screens="components.screens.*"
                    xmlns:notif="components.notifications.*"
                    xmlns:building="components.buildingsidebar.*"
                    xmlns:buildingSelected="components.buildingselectedsidebar.*"
                    xmlns:quests="components.quests.*"
                    xmlns:viewport="components.base.viewport.*"
                    xmlns:squadronsscreen="components.squadronsscreen.*"
                    xmlns:infoscreen="components.infoscreen.*"
                    xmlns:foliage="components.foliage.*"
                    xmlns:ratings="components.ratings.*"
                    xmlns:space="components.map.space.*"
                    xmlns:firstlogin="components.firstlogin.*"
                    xmlns:healing="components.healing.*"
                    xmlns:cchat="components.chat.*"
                    xmlns:alliance="components.alliance.*"
                    xmlns:credits="components.credits.*"
                    xmlns:player="components.player.*"
                    xmlns:defensiveportal="components.defensiveportal.*"
                    xmlns:market="components.market.*"
                    xmlns:screen="components.base.screen.*"
                    xmlns:simple="components.unitsscreen.simple.*" 
                    xmlns:facilities="components.unitsscreen.facilities.*" 
                    xmlns:loadunload="components.unitsscreen.loadunload.*"
                    xmlns:announcement="components.announcement.*">
   <fx:Script>
      <![CDATA[
         import components.dailybonus.DailyBonusComp;
         import components.dailybonus.DailyBonusEvent;
         import components.popups.ActionConfirmationPopup;
         import components.skins.DailyBonusButtonSkin;
         
         import controllers.GlobalFlags;
         import controllers.dailybonus.DailyBonusCommand;
         import controllers.screens.MainAreaScreens;
         import controllers.screens.SidebarScreens;
         
         import models.solarsystem.MSSObject;
         
         import mx.events.FlexEvent;
         
         import utils.locale.Localizer;
         
         
         /**
          * Shows sidebar if it is not currently visible.
          */
         public function expandSidebar() : void
         {
            sidebarVisible = true;
         }
         
         [Bindable]
         private var sidebarVisible: Boolean = false;
         
         /**
          * Hides the sidebar if it is visible.
          */
         public function collapseSidebar() : void
         {
            sidebarVisible = false;
         }
         
         private function showDailyBonus(): void
         {
            var popUp: ActionConfirmationPopup = new ActionConfirmationPopup();
            var cont: DailyBonusComp = new DailyBonusComp();
            cont.reward = ML.player.dailyBonus;
            cont.addEventListener(DailyBonusEvent.CLOSE_PANEL, 
               function(e: DailyBonusEvent):void
               {
                  popUp.close();
               });
            popUp.title = Localizer.string('Popups', 'title.dailyBonus');
            popUp.addElement(cont);
            popUp.confirmButtonLabel = Localizer.string('Quests', 'label.claimReward');
            popUp.cancelButtonLabel = Localizer.string('Quests', 'label.claimLater');
            popUp.confirmButtonClickHandler = function(button: Button):void
            {
               GlobalFlags.getInstance().lockApplication = true;
               new DailyBonusCommand(DailyBonusCommand.CLAIM, 
                  {'planetId': MSSObject(cont.planetSelector.selectedItem).id}
               ).dispatch();
            };
            popUp.show();
         }
         
      ]]>
   </fx:Script>
   <s:Group left="0" top="0" bottom="0"
            right="{sidebarVisible?240:0}">
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.GALAXY}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.SOLAR_SYSTEM}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.PLANET}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.TECH_TREE}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.FACILITIES}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.UNITS}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.STORAGE}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.LOAD_UNLOAD}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.HEAL}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.INFO}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.NOTIFICATIONS}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.QUESTS}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.SQUADRONS}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.RATINGS}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.MARKET}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.PLAYER}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.DEFENSIVE_PORTAL}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.VIP}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.ALLY_RATINGS}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.ALLIANCE}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.WELCOME}"/>
      <screen:MainAreaScreenContainer screenName="{MainAreaScreens.CHAT}"/>
      <base:TopMessage bottom="20" horizontalCenter="0" width="100%" visible="false"/>
      <s:Group left="0" top="200">
         <s:layout>
            <s:VerticalLayout horizontalAlign="left" gap="20"/>
         </s:layout>
         <s:Button skinClass="components.skins.DailyBonusButtonSkin"
                   visible="{ML.player.dailyBonus != null}" click="showDailyBonus()"/>
         <announcement:AnnouncementButton/>
      </s:Group>
   </s:Group>
   
   <s:SkinnableContainer id="rightSidebarContainer"
                         styleName="rightSidebarContainer"
                         top="0" bottom="0" right="0"
                         width="{sidebarVisible?240:0}"
                         mouseEnabled="{sidebarVisible}"
                         mouseChildren="{sidebarVisible}">
      <s:Group left="0" right="0" top="0" bottom="0">
         <screen:SidebarScreenContainer screenName="{SidebarScreens.EMPTY}"/>
         <screen:SidebarScreenContainer screenName="{SidebarScreens.CONSTRUCTION}"/>
         <screen:SidebarScreenContainer screenName="{SidebarScreens.TECH_TREE_INFO}"/>
         <screen:SidebarScreenContainer screenName="{SidebarScreens.TECH_TREE_BASE}"/>
         <screen:SidebarScreenContainer screenName="{SidebarScreens.BUILDING_SELECTED}"/>
         <screen:SidebarScreenContainer screenName="{SidebarScreens.BLOCKING_FOLLIAGE}"/>
         <screen:SidebarScreenContainer screenName="{SidebarScreens.UNITS_ACTIONS}"/>
         <screen:SidebarScreenContainer screenName="{SidebarScreens.LOAD_UNLOAD}"/>
         <screen:SidebarScreenContainer screenName="{SidebarScreens.HEAL}"/>
         <screen:SidebarScreenContainer screenName="{SidebarScreens.MARKET}"/>
      </s:Group>
   </s:SkinnableContainer>
</base:BaseContainer>
