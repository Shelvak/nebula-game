<?xml version="1.0"?>
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009"
         xmlns:s="library://ns.adobe.com/flex/spark"
         xmlns:planetmapeditor="components.planetmapeditor.*"
         xmlns:viewport="components.base.viewport.*"
         width="100%" height="100%">
   <s:layout>
      <s:VerticalLayout horizontalAlign="justify" gap="0"/>
   </s:layout>
   <fx:Script>
      <![CDATA[
      import models.tile.TerrainType;

      import spark.events.IndexChangeEvent;

      import utils.StringUtil;


      private const MODEL: MPlanetMapEditor = new MPlanetMapEditor();

      private function getTerrainName(type: int): String {
         return StringUtil.firstToUpperCase(TerrainType.getName(type));
      }

      private function ddlTerrainTypes_changeHandler(event: IndexChangeEvent): void {
         if (event.newIndex >= 0) {
            MODEL.terrainType = ddlTerrainTypes.selectedItem;
         }
      }

      private function lstTileTypes_changeHandler(event: IndexChangeEvent): void {
         if (event.newIndex >= 0) {
            MODEL.selectedTileKind = lstTileTypes.selectedItem;
         }
      }

      private function lstBuildings_changeHandler(event: IndexChangeEvent): void {
      }

      private function btnGenerate_clickHandler(event: MouseEvent): void {
         MODEL.generateMap(mapViewport);
      }
      ]]>
   </fx:Script>
   <s:SkinnableContainer height="30"
                         skinClass="components.skins.TopToolbarContainerSkin">
      <s:layout>
         <s:HorizontalLayout paddingLeft="10" verticalAlign="middle" gap="10"/>
      </s:layout>
      <s:Label text="Size:"/>
      <s:Group>
         <s:layout>
            <s:HorizontalLayout verticalAlign="middle" gap="4"/>
         </s:layout>
         <s:NumericStepper id="stepWidth"
                           minimum="{MODEL.MIN_WIDTH}"
                           maximum="{MODEL.MAX_WIDTH}"
                           value="@{MODEL.mapWidth}"/>
         <s:Label text="x"/>
         <s:NumericStepper id="spnHeight"
                           minimum="{MODEL.MIN_HEIGHT}"
                           maximum="{MODEL.MAX_HEIGHT}"
                           value="@{MODEL.mapHeight}"/>
      </s:Group>
      <s:Button id="btnGenerate" label="Generate" click="btnGenerate_clickHandler(event)"/>
      <s:Button id="btnLoad" label="Load"/>
      <s:Button id="btnSave" label="Save"/>
   </s:SkinnableContainer>
   <s:Group height="100%">
      <s:layout>
         <s:HorizontalLayout verticalAlign="justify" gap="0"/>
      </s:layout>
      <viewport:ViewportZoomable id="mapViewport" width="100%"
                                 paddingHorizontal="100"
                                 paddingVertical="100"/>
      <s:SkinnableContainer styleName="rightSidebarContainer" width="240">
         <planetmapeditor:CObjectsToErect model="{MODEL}"
                                          horizontalCenter="0"
                                          width="200" height="100%"/>
      </s:SkinnableContainer>
   </s:Group>
   <s:SkinnableContainer mouseEnabled="false" height="70"
                         skinClass="components.skins.BottomToolbarContainerSkin">
      <s:layout>
         <s:HorizontalLayout paddingLeft="20" gap="5"
                             verticalAlign="middle" horizontalAlign="left"/>
      </s:layout>
      <s:DropDownList id="ddlTerrainTypes"
                      requireSelection="true" selectedIndex="0"
                      dataProvider="{MODEL.TERRAIN_TYPES}"
                      labelFunction="getTerrainName"
                      change="ddlTerrainTypes_changeHandler(event)">
         <s:layout>
            <s:VerticalLayout horizontalAlign="contentJustify"/>
         </s:layout>
      </s:DropDownList>
      <s:List id="lstTileTypes" height="100%"
              requireSelection="true" selectedIndex="0"
              dataProvider="{MODEL.TILE_KINDS}"
              itemRenderer="components.planetmapeditor.IRTileKind"
              borderVisible="false"
              change="lstTileTypes_changeHandler(event)">
         <s:layout>
            <s:HorizontalLayout gap="2" verticalAlign="middle"/>
         </s:layout>
      </s:List>
   </s:SkinnableContainer>
</s:Group>
