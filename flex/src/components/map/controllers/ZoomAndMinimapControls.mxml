<?xml version="1.0" encoding="utf-8"?>
<base:BaseContainer xmlns:fx="http://ns.adobe.com/mxml/2009" 
                    xmlns:s="library://ns.adobe.com/flex/spark" 
                    xmlns:mx="library://ns.adobe.com/flex/mx"
                    xmlns:base="components.base.*"
                    xmlns:ctrl="components.map.controllers.*"
                    xmlns:minimap="components.map.controllers.minimap.*"
                    implements="components.map.controllers.IMapViewportController"
                    left="0" right="0" top="0" bottom="0"
                    initialize="this_initializeHandler(event)">
   
   <fx:Binding destination="_viewport.paddingHorizontal" source="minimap.width"/>
   
   <fx:Script>
      <![CDATA[
         import components.base.viewport.Viewport;
         import components.base.viewport.ViewportZoomable;
         
         import mx.events.FlexEvent;
         
         
         [Bindable]
         private var _viewport:ViewportZoomable;
         
         
         public function setViewport(viewport:Viewport) : void
         {
            _viewport = ViewportZoomable(viewport);
            initializeControllers();
         }
         
         
         public function cleanup() : void
         {
            zoomController.cleanup();
            minimap.cleanup();
            _viewport = null;
         }

         
         protected function this_initializeHandler(event:FlexEvent):void
         {
            initializeControllers();
         }
         
         
         private function initializeControllers() : void
         {
            if (minimap)
            {
               zoomController.setViewport(_viewport);
            }
            if (zoomController)
            {
               minimap.setViewport(_viewport);
            }
         }
      ]]>
   </fx:Script>
   
   <minimap:Minimap id="minimap" top="0" left="0" width="{_viewport.width * 0.2}" height="{_viewport.height * 0.2}"/>
   <ctrl:ViewportZoomController id="zoomController" left="0" top="{minimap.height + 2}"/>
   
</base:BaseContainer>
